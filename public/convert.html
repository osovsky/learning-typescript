<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Конвертер валют — EUR, USD, UAH</title>
  <link rel="stylesheet" href="styles.css" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet" />
  <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="manifest" href="site.webmanifest">
</head>

<body>
  <header>
    <div class="logo-container">
      <a href="https://www.youtube.com/SergOMusic" target="_blank">
        <img src="./images/logo.jpg" alt="Logo" class="logo" />
      </a>
    </div>
    <button id="hamburger-btn" class="hamburger-icon" aria-expanded="false" aria-controls="mobile-nav">
      <span class="bar"></span>
      <span class="bar"></span>
      <span class="bar"></span>
    </button>
  </header>

  <div class="container">
    <!-- Левая навигация -->
    <div class="sidebar-left" id="mobile-nav"> 
      <nav>
        <p class="close-menu-container"><a href="#" id="menu-close-btn" class="menu-close-btn">
          <i class="fas fa-arrow-left"></i>Close</a></p>
        <p><a href="/">Home</a></p>
        <p><a href="songs">Songs</a></p>
        <p><a href="ambient">Ambient</a></p>
        <p><a href="about">Über mich</a></p>
        <p><a href="convert">Currency Converter</a></p>
        <p><a href="days-app">Days Calculator</a></p>
      </nav>
    </div>

    <!-- Основной контент -->
    <div class="main-content">
      <div class="converter-box">
        <h2>Конвертер валют (EUR, USD, UAH)</h2>

        <label for="usd">Скільки у вас USD:</label>
        <input id="usd" type="number" placeholder="0" step="0.01" min="0"/>

        <label for="eur">Скільки у вас EUR:</label>
        <input id="eur" type="number" placeholder="0" step="0.01" min="0"/>

        <label for="uah">Скільки у вас UAH:</label>
        <input id="uah" type="number" placeholder="0" step="0.01" min="0"/>

        <button id="calcBtn">Розрахувати</button>

        <div class="result-box" id="result">Введіть суми і натисніть «Розрахувати»</div>
        <div class="small" id="ratesInfo"></div>
      </div>
    </div>
  </div>

  <footer>
    <p>© 2025 Musik Serg Osovskyi. Дані з офіційних джерел (PrivatBank/Monobank/NBU)</p>
    <div class="social-icons">
      <a href="https://www.facebook.com/sergii.osovskyi/" target="_blank" class="social-icon facebook"><i class="fab fa-facebook-f"></i></a>
      <a href="https://www.instagram.com/sergosovskyi/" target="_blank" class="social-icon instagram"><i class="fab fa-instagram"></i></a>
      <a href="https://www.tiktok.com/@serhiiosovskyi" target="_blank" class="social-icon tiktok"><i class="fab fa-tiktok"></i></a>
      <a href="https://www.youtube.com/SergOMusic" target="_blank" class="social-icon youtube"><i class="fab fa-youtube"></i></a>
      <a href="mailto:sergoguitarmusic@gmail.com" target="_blank" class="social-icon email"><i class="fas fa-envelope"></i></a>
    </div>
  </footer>

  <script>
    const usdIn = document.getElementById('usd');
    const eurIn = document.getElementById('eur');
    const uahIn = document.getElementById('uah');
    const btn = document.getElementById('calcBtn');
    const resultEl = document.getElementById('result');
    const ratesInfo = document.getElementById('ratesInfo');

    async function computeServer() {
      const params = new URLSearchParams({
        usd: usdIn.value || '0',
        eur: eurIn.value || '0',
        uah: uahIn.value || '0'
      });

      resultEl.textContent = '⏳ Розрахунок...';
      try {
        const resp = await fetch(`/api/convert?${params.toString()}`);
        if (!resp.ok) throw new Error('Server error ' + resp.status);
        const data = await resp.json();

        if (data.result) {
          const r = data.result.breakdown;
          resultEl.innerHTML = `
            <strong>Разом: ${data.result.eur_total.toFixed(2)} €</strong><br>
            <small>EUR: ${r.eur_self.toFixed(2)}, з USD → EUR: ${r.eur_from_usd.toFixed(2)}, з UAH → EUR: ${r.eur_from_uah.toFixed(2)}</small>
          `;
          ratesInfo.textContent = `${data.source} · ${new Date(data.fetchedAt).toLocaleString()} · USD_buy=${data.usedRates.USD_buy} · EUR_sale=${data.usedRates.EUR_sale}`;
        } else {
          resultEl.textContent = 'Помилка при отриманні даних';
        }
      } catch (e) {
        console.error(e);
        resultEl.textContent = '❌ Не вдалося отримати результат';
      }
    }

    btn.addEventListener('click', computeServer);
    </script>
    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const hamburgerBtn = document.getElementById('hamburger-btn');
        const mobileNav = document.getElementById('mobile-nav');
        // НОВЫЙ ЭЛЕМЕНТ: Кнопка "Закрыть" внутри меню
        const menuCloseBtn = document.getElementById('menu-close-btn');

        // Функция для закрытия меню
        const closeMenu = () => {
            hamburgerBtn.classList.remove('open');
            mobileNav.classList.remove('open');
            hamburgerBtn.setAttribute('aria-expanded', 'false');
        };

        // Функция для открытия/закрытия меню по иконке
        const toggleMenu = () => {
            const isExpanded = hamburgerBtn.getAttribute('aria-expanded') === 'true';
            hamburgerBtn.classList.toggle('open');
            mobileNav.classList.toggle('open');
            hamburgerBtn.setAttribute('aria-expanded', !isExpanded);
        };

        if (hamburgerBtn && mobileNav) {
            // 1. Обработка клика по гамбургер-иконке
            hamburgerBtn.addEventListener('click', toggleMenu);
            
            // 2. ОБРАБОТКА КЛИКА ПО КНОПКЕ "ЗАКРЫТЬ" ВНУТРИ МЕНЮ
            if (menuCloseBtn) {
                menuCloseBtn.addEventListener('click', (e) => {
                    e.preventDefault(); // Предотвращаем переход по ссылке '#'
                    closeMenu();
                });
            }

            // 3. Закрытие меню при клике на обычную ссылку
            mobileNav.querySelectorAll('a:not(.menu-close-btn)').forEach(link => {
                link.addEventListener('click', () => {
                    // Используем setTimeout, чтобы позволить ссылке сработать до закрытия
                    setTimeout(closeMenu, 50); 
                });
            });
        }
    });
</script>
</body>
</html>
